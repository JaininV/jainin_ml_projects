MEXICO CITY — Mexico's Supreme Court ruled Tuesday that last year's transfer of the newly created National Guard from civilian to military control was unconstitutional, dealing a blow to President Andrés Manuel López Obrador who created the security force in 2019.

The vast majority of the National Guard's members and leadership came from Mexico's military, but it was described as a civilian force and placed under the control of the civilian public security ministry. López Obrador created it with a constitutional reform to replace the disbanded federal police.

Last year, Mexico's Congress passed legislation shifting control of the National Guard to the military. López Obrador had argued then, as he repeated Tuesday, that it was the only way to avoid the corruption that engulfed the federal police.

Legal challenges were mounted immediately, noting that since the civilian nature of the National Guard was enshrined in the constitution, it could only be changed through another constitutional reform. By then however, López Obrador's ruling party and allies no longer had the necessary majority in Congress.

The attempted shift fed criticism that López Obrador was militarizing Mexico.

Troops had already been critical in previous administrations in combatting the powerful and heavily-armed drug cartels. But rather than sending them back to the barracks as López Obrador had once advocated, he cemented their role in Mexico's public security.

Last October, the Congress extended the time the military would be able to continue performing a domestic law enforcement role to 2028. Previously, that role was supposed to end in 2024. The Mexican public has expressed higher levels of trust in the military than in police in polling.

López Obrador also vastly expanded the military's responsibilities, putting them in charge of ports and customs, as well as his signature projects like building a new Mexico City airport and a tourist train on the Yucatan Peninsula.

While the National Guard — now some 128,000 strong — could muster the firepower to match the cartels, it did not have the investigative capacity of a civilian police force. Critics have said the National Guard has largely operated as a visible patrolling presence in Mexico's many insecure areas, but is not dismantling organized criminal capability.

Eight of the court's 11 ministers ruled the transfer to military control unconstitutional.

On Tuesday morning, before the court's decision, López Obrador criticized the court broadly for not producing justice and personally for court members' salaries.

"If the National Guard isn't under the defense secretary and goes on like before when it was under the public security secretary … look how the federal police ended up: completely corrupt," López Obrador said.